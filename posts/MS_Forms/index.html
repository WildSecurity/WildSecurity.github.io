<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Malicious Forms" /><meta property="og:locale" content="en" /><meta name="description" content="Today we investigate a very interesting story. A user told us, he noticed his account was sending Microsoft Forms to internal people, and he believes he did not do that." /><meta property="og:description" content="Today we investigate a very interesting story. A user told us, he noticed his account was sending Microsoft Forms to internal people, and he believes he did not do that." /><link rel="canonical" href="https://wilddogone.github.io//posts/MS_Forms/" /><meta property="og:url" content="https://wilddogone.github.io//posts/MS_Forms/" /><meta property="og:site_name" content="About Security" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-14T20:39:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Malicious Forms" /><meta name="twitter:site" content="@none" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-14T20:39:00+02:00","datePublished":"2022-06-14T20:39:00+02:00","description":"Today we investigate a very interesting story. A user told us, he noticed his account was sending Microsoft Forms to internal people, and he believes he did not do that.","headline":"Malicious Forms","mainEntityOfPage":{"@type":"WebPage","@id":"https://wilddogone.github.io//posts/MS_Forms/"},"url":"https://wilddogone.github.io//posts/MS_Forms/"}</script><title>Malicious Forms | About Security</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="About Security"><meta name="application-name" content="About Security"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">About Security</a></div><div class="site-subtitle font-italic">Blue and Red</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/WildDogOne" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/none" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Malicious Forms</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Malicious Forms</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/WildDogOne/">WildDogOne</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1655231940" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-14 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="569 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><p>Today we investigate a very interesting story. A user told us, he noticed his account was sending <a href="https://forms.office.com/">Microsoft Forms</a> to internal people, and he believes he did not do that.</p><h2 id="the-alert"><span class="mr-2">The Alert</span><a href="#the-alert" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Usually when a user tells us that their account is used to send out phishing, it’s very likely true positive. So we went ahead and checked this asap. But it got worse, the Mail was proven to be sent intra-org from a company IP, red alert in my opinion. Before going crazy, I made my own form and tried to figure out if there is a way from within forms to send mails, nope</p><p>Hunting Query:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">let</span><span class="w"> </span><span class="nx">time_span</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="nt">-06-14T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">);</span><span class="w">
</span><span class="n">EmailEvents</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="nx">Timestamp</span><span class="w"> </span><span class="nx">between</span><span class="w"> </span><span class="p">(</span><span class="n">time_span</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="p">(</span><span class="n">time_span</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">1d</span><span class="p">))</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="nx">SenderFromAddress</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"userA@company.domain"</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="nx">RecipientEmailAddress</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"userB@company.domain"</span><span class="w">
</span></pre></table></code></div></div><h2 id="hunting-deeper"><span class="mr-2">Hunting deeper</span><a href="#hunting-deeper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now we definitely needed to go deeper, because this feels like a major breach. The only explanation would be someone got credentials and MFA from a person, logged into their VPN, and then from there started sending malicious MS Forms. Scary!</p><p>So first I started hunting for the form name through all M365 I had</p><p>Hunting Query:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">search</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s2">"Formname"</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">Timestamp</span><span class="w"> </span><span class="nx">asc</span><span class="w">
</span></pre></table></code></div></div><p>This gave me some very strange results, there are multiple forms going around with same and similar names but multiple form IDs. OK so far so useless, so I added time to the equation</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">let</span><span class="w"> </span><span class="nx">time_span</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="nt">-06-14T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">);</span><span class="w">
</span><span class="n">search</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CloudAppEvents</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s2">"Formname"</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="nx">Timestamp</span><span class="w"> </span><span class="nx">between</span><span class="w"> </span><span class="p">(</span><span class="n">time_span</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="p">(</span><span class="n">time_span</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">1d</span><span class="p">))</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">Timestamp</span><span class="w"> </span><span class="nx">asc</span><span class="w">
</span></pre></table></code></div></div><p>This gave me one form with one ID to focus on. After some time of being clueless I checked the form ID against the URL sent in the email, hard match! Finally, something to focus on.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">let</span><span class="w"> </span><span class="nx">time_span</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="nt">-06-14T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">);</span><span class="w">
</span><span class="n">search</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s2">"FORMID"</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="nx">Timestamp</span><span class="w"> </span><span class="nx">between</span><span class="w"> </span><span class="p">(</span><span class="n">time_span</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="p">(</span><span class="n">time_span</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">1d</span><span class="p">))</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">Timestamp</span><span class="w"> </span><span class="nx">asc</span><span class="w">
</span></pre></table></code></div></div><p>So far so good, the user opened the form somewhere in the morning, and then sent mails in the afternoon. But when I remove the timespan and focus on the last 30 days, I notice something peculiar. Another user, which was the recipient of the “phishing” mail, was the user who built that form with that exact ID</p><p>so the flow actually looks something like this: <script type="text/javascript" src="/assets/js/mermaid.js"></script></p><div class="mermaid"> %%{init: {"theme": "dark"}}%%; flowchart TD; userA --&gt; |CreateForm| form1Create[May 21, 2022 11:47:33 AM] --&gt; form1; userB["userA@company.domain"] --&gt;|mail logs| mailTime[14.06.22 16:25 UTC+2] --&gt;|mail| userA["userB@company.domain"]; CloudAppEvents --&gt; |ViewRuntimeForm| viewTime[Jun 14, 2022 12:30:46 PM]; viewTime --&gt; form1[FORMID]; form1 --&gt; userA --&gt; |create mail| createTime2[Jun 14, 2022 4:24:58 PM] --&gt; |send mail| mailTime;</div><h2 id="verdict"><span class="mr-2">Verdict</span><a href="#verdict" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let’s be honest here, it feels like a very strange pattern. Two users would have to be compromised, and not even close to each other in time. Of course possible, but a huge overkill of an attack, I will check this with the owner of the form, but I think all is OK Special side note, M365 features are chaos, it’s possible that the user was able to somehow automatically send Form fillout requests without noticing</p><div class="table-wrapper"><table><thead><tr><th>Indicator<th>Thoughts<th>Verdict<tbody><tr><td>User notices misuse of account<td>Very sus<td>+40%<tr><td>Mail is sent from company IP<td>High alert<td>+60%<tr><td>Form created by someone else<td>Very unusual attack pattern<td>-50%</table></div><p><strong>Verdict: False Positive</strong></p><h2 id="next-steps"><span class="mr-2">Next Steps</span><a href="#next-steps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Check the form closer for phishing behaviour</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hunting/'>Hunting</a>, <a href='/categories/m365/'>M365</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/m365/" class="post-tag no-text-decoration" >m365</a> <a href="/tags/hunting/" class="post-tag no-text-decoration" >hunting</a> <a href="/tags/false-positive/" class="post-tag no-text-decoration" >false positive</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Malicious Forms - About Security&amp;url=https://wilddogone.github.io//posts/MS_Forms/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Malicious Forms - About Security&amp;u=https://wilddogone.github.io//posts/MS_Forms/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://wilddogone.github.io//posts/MS_Forms/&amp;text=Malicious Forms - About Security" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Debugging_Ingest_Pipelines/">Debugging Elastic Pipelines</a><li><a href="/posts/Elastic_Risk_Model/">Building a Risk Model in Elastic</a><li><a href="/posts/Building_Security/">Building Home Security</a><li><a href="/posts/Elastic_Security/">Building Elastic Security</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/elastic/">elastic</a> <a class="post-tag" href="/tags/howto/">howto</a> <a class="post-tag" href="/tags/hunting/">hunting</a> <a class="post-tag" href="/tags/mde/">mde</a> <a class="post-tag" href="/tags/false-positive/">false positive</a> <a class="post-tag" href="/tags/true-positive/">true positive</a> <a class="post-tag" href="/tags/elastalert/">elastalert</a> <a class="post-tag" href="/tags/m365/">m365</a> <a class="post-tag" href="/tags/psexec/">psexec</a> <a class="post-tag" href="/tags/thehive/">thehive</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Powershell-PSexec/"><div class="card-body"> <em class="timeago small" data-ts="1652816340" > 2022-05-17 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Powershell and PSExec</h3><div class="text-muted small"><p> Today we investigate some strange behaviour from a (possibly user) executed Powershell session. The Alert Everything started with an explorer.exe running the following commandline. &quot;cmd.exe&quot; /...</p></div></div></a></div><div class="card"> <a href="/posts/Mac-Malware/"><div class="card-body"> <em class="timeago small" data-ts="1652953140" > 2022-05-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Mac Malware?</h3><div class="text-muted small"><p> Today we investigate some strange discovery actions by processes on a macbook The Alert In the essence this alert was showing multiple different processes doing very similar actions, for the sake...</p></div></div></a></div><div class="card"> <a href="/posts/Admin_Login_Failure/"><div class="card-body"> <em class="timeago small" data-ts="1653158340" > 2022-05-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Unusual number of failed sign-in attempts</h3><div class="text-muted small"><p> Today we investigate some failed logins The Alert Todays alert looks simple enough, failed loggins with the user “Administrator” But very quickly we see some not so good indicator, the login conne...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Elastic_Security/" class="btn btn-outline-primary" prompt="Older"><p>Building Elastic Security</p></a> <a href="/posts/Elastic_Risk_Model/" class="btn btn-outline-primary" prompt="Newer"><p>Building a Risk Model in Elastic</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/WildDogOne/">WildDogOne</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/elastic/">elastic</a> <a class="post-tag" href="/tags/howto/">howto</a> <a class="post-tag" href="/tags/hunting/">hunting</a> <a class="post-tag" href="/tags/mde/">mde</a> <a class="post-tag" href="/tags/false-positive/">false positive</a> <a class="post-tag" href="/tags/true-positive/">true positive</a> <a class="post-tag" href="/tags/elastalert/">elastalert</a> <a class="post-tag" href="/tags/m365/">m365</a> <a class="post-tag" href="/tags/psexec/">psexec</a> <a class="post-tag" href="/tags/thehive/">thehive</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
