<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Building Elastic Security" /><meta property="og:locale" content="en" /><meta name="description" content="Recently I have started to rebuild my home security setup. This included getting my Elastic Security up and running again. And in this blog entry I want to write a bit about it. However, since Elastic is such a vast topic, I will assume your stack is already up and running, no tshooting of that from me ;)" /><meta property="og:description" content="Recently I have started to rebuild my home security setup. This included getting my Elastic Security up and running again. And in this blog entry I want to write a bit about it. However, since Elastic is such a vast topic, I will assume your stack is already up and running, no tshooting of that from me ;)" /><link rel="canonical" href="https://wilddogone.github.io//posts/Elastic_Security/" /><meta property="og:url" content="https://wilddogone.github.io//posts/Elastic_Security/" /><meta property="og:site_name" content="About Security" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-09T18:40:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Building Elastic Security" /><meta name="twitter:site" content="@none" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-09T19:59:33+02:00","datePublished":"2022-06-09T18:40:00+02:00","description":"Recently I have started to rebuild my home security setup. This included getting my Elastic Security up and running again. And in this blog entry I want to write a bit about it. However, since Elastic is such a vast topic, I will assume your stack is already up and running, no tshooting of that from me ;)","headline":"Building Elastic Security","mainEntityOfPage":{"@type":"WebPage","@id":"https://wilddogone.github.io//posts/Elastic_Security/"},"url":"https://wilddogone.github.io//posts/Elastic_Security/"}</script><title>Building Elastic Security | About Security</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="About Security"><meta name="application-name" content="About Security"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">About Security</a></div><div class="site-subtitle font-italic">Blue and Red</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/WildDogOne" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/none" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Building Elastic Security</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Building Elastic Security</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/WildDogOne/">WildDogOne</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1654792800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-09 </em> </span> <span> Updated <em class="timeago" data-ts="1654797573" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="761 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><p>Recently I have started to rebuild my home security setup. This included getting my Elastic Security up and running again. And in this blog entry I want to write a bit about it. However, since Elastic is such a vast topic, I will assume your stack is already up and running, no tshooting of that from me ;)</p><h1 id="architecture">Architecture</h1><p>In my personal opinion a modern installation of Elasticstack should look something like this: <script type="text/javascript" src="/assets/js/mermaid.js"></script></p><div class="mermaid"> %%{init: {"theme": "dark"}}%%; graph TD; Logfile --&gt; Filebeat; Syslog --&gt; Filebeat; Filebeat --&gt; agent[Elastic Agent]; Winlog[Windows Logs] --&gt; Winlogbeat --&gt; agent; ND[Network Data] --&gt; Packetbeat --&gt; agent; Metricbeat --&gt; agent; EDR[Endpoint Security] --&gt; agent; agent--&gt; fleet[Fleet Server]; fleet --&gt; Logstash; Logstash --&gt; pipeline[Ingest pipelines]; pipeline --&gt; Elasticsearch; Kibana --&gt;|Consume| Elasticsearch; enrichmentLS[Enrichments:<br />DNS<br />DB Lookups<br />Aggregations<br />etc.] -.-&gt; Logstash; enrichmentES[Enrichments:<br />Correlations<br />Geolookup<br />Inference<br />Network Direction<br />etc.] -.-&gt; pipeline;</div><p>Of course in a more professional setup it would be intelligent to add load balancing and message queues. Feel free to pepper in some kafka, RabbitMQ, Kemp, F5 etc. but for my home lab that is definitely not needed.</p><h2 id="endpoint-security"><span class="mr-2">Endpoint Security</span><a href="#endpoint-security" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This is more or less the EDR component of the elastic stack and more or less on feature parity to Endgame. It is used to gather additional telemetry but can also block malicious behaviour.</p><h2 id="beats"><span class="mr-2">Beats</span><a href="#beats" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>If possible, always use beats wherever you can. The most common beat of course is filebeat since it is used to process logfiles, cloud logs as well as syslog streams.</p><p>Often Metricbeat and Packetbeat are added to the mix to enrich data. In my opinion Packetbeat is particularly useful for endpoint security.</p><h2 id="elastic-agent"><span class="mr-2">Elastic Agent</span><a href="#elastic-agent" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The elastic agent is used to configure the endpoints with the correct beats, gather the data from the different beats and elastic endpoint agent and then ship it either directly to logstash or via a Fleet Server to elasticsearch.</p><h2 id="fleet-server"><span class="mr-2">Fleet Server</span><a href="#fleet-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>A fleet server can accept data from one or more elastic agents and ship it into Elasticsearch. This is very useful if you don’t want to bother with logstash.</p><h2 id="logstash"><span class="mr-2">Logstash</span><a href="#logstash" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Logstash is used to extract and enrich data it recieves, preferably via an elastic agent. This data is then sent to elasticsearch for indexing. Some enrichments like DNS Lookups or Elastic DB Lookups are only available in Logstash, and cannot so far be replicated by Ingest pipelines. For me this is the only reason to still use logstash.</p><h2 id="ingest-pipelines"><span class="mr-2">Ingest pipelines</span><a href="#ingest-pipelines" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The ingest pipelines are used for log extraction directly in elasticsearch. It is much easier to used compared with logstash and has some unique features which are not available in Logstash, for example inference (Machine Learning). I personally try and use more ingest pipelines and less logstash if possible</p><h2 id="elasticsearch"><span class="mr-2">Elasticsearch</span><a href="#elasticsearch" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This the Database :)</p><h2 id="kibana"><span class="mr-2">Kibana</span><a href="#kibana" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The frontend UI for the whole stack, and also the place we will be in the most time.</p><h1 id="getting-data">Getting Data</h1><p>Now that we know a bit about what our setup looks like, let’s get into configuring the security parts, and some other additional things if necessary. But as stated before, I have no intention of writing elastic stack basics.</p><h2 id="fleet"><span class="mr-2">Fleet</span><a href="#fleet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="settings"><span class="mr-2">Settings</span><a href="#settings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>First we need data and for that, I utilise elastic fleet you can get there via the main menu -&gt; Management -&gt; Fleet Step one go to settings, and setup an output (most likely an elasticsearch node, since logstash is in beta)</p><h3 id="agent-policy"><span class="mr-2">Agent Policy</span><a href="#agent-policy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>After that setup your first Agent Policy, for simplicity I also deploy a Fleet Server in the same policy.</p><p>Some interesting integrations (for Windows):</p><ul><li>Fleet Server<li>Endpoint Security<li>Prebuilt Security Detection Rules<li>System<li>Windows</ul><p>Some interesting integrations (for Linux):</p><ul><li>Fleet Server<li>Endpoint Security<li>Prebuilt Security Detection Rules<li>System<li>Auditd</ul><p>Most integrations are very straight forward to deploy (just add them to the correct policy), except “Endpoint Security”, on Linux make sure to add the flag “Include Session Data” {: .prompt-info } This is only possible <em>after</em> adding the integration to the agent policy and then editing it again.</p><h3 id="agent"><span class="mr-2">Agent</span><a href="#agent" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Go to Agents and click “Add agent” in the following prompts select the correct policy, select “Quick Start” (of course, don’t do that in production). Under add fleet server host if you are deploying a fleet server in the policy point to https://127.0.0.1:8220 (default), otherwise point to wherever your fleet server host is. After that you can generate a service token and deploy an agent wherever you want. As soon as the agent is deployed it should pull its configuration and start sending the data you selected.</p><h1 id="elastic-security">Elastic Security</h1><h2 id="default-rules"><span class="mr-2">Default Rules</span><a href="#default-rules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>First let’s enable the default rules by going to Security -&gt; Alerts -&gt; Rules and downloading the default policies.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/elastic/'>elastic</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/elastic/" class="post-tag no-text-decoration" >elastic</a> <a href="/tags/howto/" class="post-tag no-text-decoration" >howto</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Building Elastic Security - About Security&amp;url=https://wilddogone.github.io//posts/Elastic_Security/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Building Elastic Security - About Security&amp;u=https://wilddogone.github.io//posts/Elastic_Security/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://wilddogone.github.io//posts/Elastic_Security/&amp;text=Building Elastic Security - About Security" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Debugging_Ingest_Pipelines/">Debugging Elastic Pipelines</a><li><a href="/posts/Elastic_Risk_Model/">Building a Risk Model in Elastic</a><li><a href="/posts/Building_Security/">Building Home Security</a><li><a href="/posts/Elastic_Security/">Building Elastic Security</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/elastic/">elastic</a> <a class="post-tag" href="/tags/howto/">howto</a> <a class="post-tag" href="/tags/hunting/">hunting</a> <a class="post-tag" href="/tags/mde/">mde</a> <a class="post-tag" href="/tags/false-positive/">false positive</a> <a class="post-tag" href="/tags/true-positive/">true positive</a> <a class="post-tag" href="/tags/elastalert/">elastalert</a> <a class="post-tag" href="/tags/m365/">m365</a> <a class="post-tag" href="/tags/psexec/">psexec</a> <a class="post-tag" href="/tags/thehive/">thehive</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Building_Security/"><div class="card-body"> <em class="timeago small" data-ts="1654789140" > 2022-06-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Building Home Security</h3><div class="text-muted small"><p> Recently I have been revamping my home security setup. In this Blog I will try and reflect on what all used to build it and how I am planning to improve. Architecture %%{init: {&quot;theme&quot;: &quot;dark&quot;...</p></div></div></a></div><div class="card"> <a href="/posts/Elastic_Risk_Model/"><div class="card-body"> <em class="timeago small" data-ts="1659119940" > 2022-07-29 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Building a Risk Model in Elastic</h3><div class="text-muted small"><p> Lately I have been thinking about how to do a risk scoring model in Elasticsearch. Yes I am aware that there are risk models for users and for hosts But these are heavily dependent on machine learn...</p></div></div></a></div><div class="card"> <a href="/posts/Debugging_Ingest_Pipelines/"><div class="card-body"> <em class="timeago small" data-ts="1660291680" > 2022-08-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Debugging Elastic Pipelines</h3><div class="text-muted small"><p> Over the past weeks I have been migrating to Elasticsearch 8.x with Fleet Agents. This brought some more annoying challenges, namely debugging Ingest Pipelines and trying to figure out how this cou...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Building_Security/" class="btn btn-outline-primary" prompt="Older"><p>Building Home Security</p></a> <a href="/posts/MS_Forms/" class="btn btn-outline-primary" prompt="Newer"><p>Malicious Forms</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/WildDogOne/">WildDogOne</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/elastic/">elastic</a> <a class="post-tag" href="/tags/howto/">howto</a> <a class="post-tag" href="/tags/hunting/">hunting</a> <a class="post-tag" href="/tags/mde/">mde</a> <a class="post-tag" href="/tags/false-positive/">false positive</a> <a class="post-tag" href="/tags/true-positive/">true positive</a> <a class="post-tag" href="/tags/elastalert/">elastalert</a> <a class="post-tag" href="/tags/m365/">m365</a> <a class="post-tag" href="/tags/psexec/">psexec</a> <a class="post-tag" href="/tags/thehive/">thehive</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
